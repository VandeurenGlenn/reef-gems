<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/firebase-element/firebase-auth.html">
<link rel="import" href="..\..\bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="..\..\bower_components/paper-input/paper-input.html">
<link rel="import" href="..\..\bower_components/paper-fab/paper-fab.html">

<dom-module id="reefgems-admin-login">
  <template>
    <style>
      :host {
        display: block;
      }
      .horizontal {
        @apply(--layout-horizontal);
        @apply(--layout-center);
      }
      :host[disabled] {
        display: none;
      }
      paper-dialog {
        background: #FFFFFF;
      }
      paper-input {

      }
    </style>
    <firebase-auth location="https://reefgems.firebaseio.com" user="{{admin}}" provider="password"></firebase-auth>
    <paper-dialog opened$="[[_computeAdminLoginOpened(admin, route)]]" with-backdrop>
      <h2>Admin Login</h2>
      <paper-input label="email" type="email"  value="{{email}}" auto-validate autocomplete></paper-input>
      <paper-input label="password" type="password" value="{{password}}"></paper-input>
      <span class="horizontal">
        <span class="flex"></span>
        <paper-fab icon="check" title="Login" on-tap="login"></paper-fab>
      </span>

    </paper-dialog>
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'reefgems-admin-login',

      properties: {
        admin: {
          type: Object,
          notify: true
        },
        route: {
          type: String
        }
      },

      _computeAdminLoginOpened: function (admin, route) {
        if (route !== 'admin' || admin) {
          return false;
        } if (route === 'admin' && admin === null) {
          return true;
        }
      },

      login: function () {
        this.querySelector('firebase-auth').login({email: this.email, password: this.password});
      }
    });
  })();
  </script>
</dom-module>
